# Based on "Avril 14th" by Aphex Twin

import audio_janq0 as a
from functools import cache

@cache 
def synth(freq):
    return (sum(
        (1/2)**i * a.sine(i*freq) for i in range(1, 13)
    ) * a.rise(0.02) * a.decay(0.1).over(0.6)).normalised()

def note(ratio, beats):
    return (synth(ROOT * ratio), beats * BEAT)

def note_oct(ratio, beats):
    return (0.5 * (synth(ROOT * ratio) + synth(2 * ROOT * ratio)), beats * BEAT)

def note_chord(ratios, beats):
    return (sum(synth(ROOT * r) for r in ratios), beats * BEAT)

ROOT = 440
BEAT = .4
# a.SAMPRATE = 10_000

right = []
left = []

right.append(note(5/4, 2))
right.append(note(5/6, 2))
right.append(note(1, 3))
right.append(note(1, 1/2))
right.append(note(5/6, 7/2))
left.append(note(1 / 4, 1))
left.append(note(5/6 / 2, 1))
left.append(note(1 / 2, 1))
left.append(note(5/4 / 2, 1))
left.append(note(5/4 / 4, 1))
left.append(note(1 / 2, 1))
left.append(note(5/4 / 2, 1))
left.append(note(3/2 / 2, 1))

right.append(note(5/6, 1))
right.append(note(3/2, 1))
right.append(note(4/3, 1))
right.append(note(5/4, 1))
right.append(note(1, 1))
left.append(note(4/3 / 4, 1))
left.append(note(1/2, 1))
left.append(note(4/3 / 2, 1))
left.append(note(3/2 / 2, 1))
left.append(note(9/8 / 4, 1))
left.append(note(1 / 2, 1))
left.append(note(4/3 / 2, 1))
left.append(note(5/4 / 2, 1))

# Uncomment for the full song
# right.append(note(5/4, 2))
# right.append(note(5/6, 2))
# right.append(note(1, 3))
# right.append(note(1, 1/2))
# right.append(note(5/6, 7/2))
# left.append(note(1 / 4, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(5/4 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(3/2 / 2, 1))

# right.append(note(5/6, 1))
# right.append(note(3/2, 1))
# right.append(note(4/3, 1))
# right.append(note(5/4, 1))
# right.append(note(1, 1))
# left.append(note(4/3 / 4, 1))
# left.append(note(1/2, 1))
# left.append(note(4/3 / 2, 1))
# left.append(note(3/2 / 2, 1))
# left.append(note(9/8 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(4/3 / 2, 1))
# left.append(note(5/4 / 2, 1))

# right.append(note_oct(5/4, 2))
# right.append(note_oct(5/6, 2))
# right.append(note_oct(1, 3))
# right.append(note_oct(1, 1/2))
# right.append(note_oct(5/6, 17/2))
# left.append(note_oct(1 / 4, 1))
# left.append(note_oct(5/6 / 2, 1))
# left.append(note_oct(1 / 2, 1))
# left.append(note_oct(5/4 / 2, 1))
# left.append(note_oct(5/4 / 4, 1))
# left.append(note_oct(1 / 2, 1))
# left.append(note_oct(5/4 / 2, 1))
# left.append(note_oct(3/2 / 2, 1))

# left.append(note_oct(4/3 / 4, 1))
# left.append(note_oct(1/2, 1))
# left.append(note_oct(4/3 / 2, 1))
# left.append(note_oct(3/2 / 2, 1))
# left.append(note_oct(9/8 / 4, 1))
# left.append(note_oct(1 / 2, 1))
# left.append(note_oct(4/3 / 2, 1))
# left.append(note_oct(5/4 / 2, 1))

# right.append(note_oct(5/4, 2))
# right.append(note_oct(5/6, 2))
# right.append(note_oct(1, 3))
# right.append(note_oct(1, 1/2))
# right.append(note_oct(5/6, 17/2))
# left.append(note_oct(1 / 4, 1))
# left.append(note_oct(5/6 / 2, 1))
# left.append(note_oct(1 / 2, 1))
# left.append(note_oct(5/4 / 2, 1))
# left.append(note_oct(5/4 / 4, 1))
# left.append(note_oct(1 / 2, 1))
# left.append(note_oct(5/4 / 2, 1))
# left.append(note_oct(3/2 / 2, 1))

# left.append(note_oct(4/3 / 4, 1))
# left.append(note_oct(1/2, 1))
# left.append(note_oct(4/3 / 2, 1))
# left.append(note_oct(3/2 / 2, 1))
# left.append(note_oct(9/8 / 4, 1))
# left.append(note_oct(1 / 2, 1))
# left.append(note_oct(4/3 / 2, 1))
# left.append(note_oct(5/4 / 2, 1))

# right.append(note(5/4 / 2, 3))
# right.append(note(5/4 / 2, 1/2))
# right.append(note(3/2 / 2, 3.5))
# right.append(note(5/4 / 2, 1))
# left.append(note(1 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(3/2 / 8, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))

# right.append(note(5/4 / 2, 3))
# right.append(note(5/4 / 2, 1/2))
# right.append(note(3/2 / 2, 1/2))
# right.append(note(5/3 / 2, 3))
# right.append(note(3/2 / 2, 1))
# left.append(note(1 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(4/3 / 8, 1))
# left.append(note(4/3 / 4, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(4/3 / 4, 1))


# right.append(note(5/4 / 2, 3))
# right.append(note(5/4 / 2, 1/2))
# right.append(note(3/2 / 2, 3.5))
# right.append(note(5/4 / 2, 1))
# left.append(note(1 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(3/2 / 8, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))

# right.append(note(5/4 / 2, 3))
# right.append(note(5/4 / 2, 1/2))
# right.append(note(3/2 / 2, 1/2))
# right.append(note(5/3 / 2, 3))
# right.append(note(3/2 / 2, 1))
# left.append(note(1 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(4/3 / 8, 1))
# left.append(note(4/3 / 4, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(4/3 / 4, 1))
# right.append(note(5/4 / 2, 3))
# right.append(note(5/4 / 2, 1/2))
# right.append(note(3/2 / 2, 3.5))
# right.append(note(5/4 / 2, 1))
# left.append(note(1 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(3/2 / 8, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))

# right.append(note(5/4 / 2, 3))
# right.append(note(5/4 / 2, 1/2))
# right.append(note(3/2 / 2, 1/2))
# right.append(note(5/3 / 2, 3))
# right.append(note(3/2 / 2, 1))
# left.append(note(1 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(4/3 / 8, 1))
# left.append(note(4/3 / 4, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(4/3 / 4, 1))
# right.append(note(5/4 / 2, 3))
# right.append(note(5/4 / 2, 1/2))
# right.append(note(3/2 / 2, 3.5))
# right.append(note(5/4 / 2, 1))
# left.append(note(1 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(3/2 / 8, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))

# right.append(note(5/4 / 2, 3))
# right.append(note(5/4 / 2, 1/2))
# right.append(note(3/2 / 2, 1/2))
# right.append(note(5/3 / 2, 3))
# right.append(note(3/2 / 2, 2))
# left.append(note(1 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(4/3 / 8, 1))
# left.append(note(4/3 / 4, 1))
# left.append(note(3/2 / 4, 1))
# left.append(note(4/3 / 4, 1))


# right.append(note_oct(5/3 / 2, 1))
# right.append(note_oct(15/8 / 2, 1))
# right.append(note_oct(1, 1))
# right.append(note_oct(5/4, 1))
# right.append(note_oct(15/8 / 2, 4))
# left.append(note(9/8 / 4, 1))
# left.append(note(9/8 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(1/2, 2))
# left.append(note(5/4 / 2, 1/2))
# left.append(note(9/8 / 2, 1))
# left.append(note(5/3 / 4, 1.5))

# right.append(note_oct(5/3 / 2, 1))
# right.append(note_oct(15/8 / 2, 1))
# right.append(note_oct(1, 1))
# right.append(note_oct(5/4, 1))
# right.append(note_oct(15/8 / 2, 1))
# right.append(note(5/3 / 2, 3))
# left.append(note(9/8 / 4, 1))
# left.append(note(9/8 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(1/2, 1.5))
# left.append(note(5/4 / 2, 1))
# left.append(note(9/8 / 2, 1))
# left.append(note(5/4 / 2, 1.5))

# # right.append(note_oct(5/3 / 2, 1))
# # right.append(note_oct(15/8 / 2, 1))
# # right.append(note_oct(1, 1))
# # right.append(note_oct(5/4, 1))
# # right.append(note_oct(15/8 / 2, 4))
# # left.append(note(9/8 / 4, 1))
# left.append(note(9/8 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(3/2 / 2, 2))
# left.append(note(5/4 / 2, 1/2))
# left.append(note(9/8 / 2, 1/2))
# left.append(note(1/2, 1))
# left.append(note(9/8 / 2, 1))

# right.append(note_oct(5/3 / 2, 1))
# right.append(note_oct(15/8 / 2, 1))
# right.append(note_oct(1, 1))
# right.append(note_oct(5/4, 1.5))
# right.append(note_oct(15/8 / 2, 1))
# right.append(note_oct(5/3 / 2, 1.5))
# left.append(note(9/8 / 4, 1))
# left.append(note(9/8 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(1/2, 1.5))
# left.append(note(5/4 / 2, 1))
# left.append(note(9/8 / 2, 1/2))
# left.append(note(5/4 / 2, 2))


# right.append(note(5/4, 2))
# right.append(note(5/6, 2))
# right.append(note(1, 3))
# right.append(note(1, 1/2))
# right.append(note(5/6, 7/2))
# left.append(note(1 / 4, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(5/4 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(3/2 / 2, 1))

# right.append(note(5/6, 1))
# right.append(note(3/2, 1))
# right.append(note(4/3, 1))
# right.append(note(5/4, 1))
# right.append(note(1, 1))
# left.append(note(4/3 / 4, 1))
# left.append(note(1/2, 1))
# left.append(note(4/3 / 2, 1))
# left.append(note(3/2 / 2, 1))
# left.append(note(9/8 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(4/3 / 2, 1))
# left.append(note(5/4 / 2, 1))

# right.append(note(5/4, 2))
# right.append(note(5/6, 2))
# right.append(note(1, 3))
# right.append(note(1, 1/2))
# right.append(note(5/6, 7/2))
# left.append(note(1 / 4, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(5/4 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(3/2 / 2, 1))

# right.append(note(5/6, 1))
# right.append(note(3/2, 1))
# right.append(note(4/3, 1))
# right.append(note(5/4, 1))
# right.append(note(1, 1))
# left.append(note(4/3 / 4, 1))
# left.append(note(1/2, 1))
# left.append(note(4/3 / 2, 1))
# left.append(note(3/2 / 2, 1))
# left.append(note(9/8 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(4/3 / 2, 1))
# left.append(note(5/4 / 2, 1))



# right.append(note_oct(5/4, 2))
# right.append(note_oct(5/6, 2))
# right.append(note_oct(1, 3))
# right.append(note_oct(1, 1/2))
# right.append(note_oct(5/6, 7/2))
# left.append(note(1 / 4, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(5/4 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(3/2 / 2, 1))

# right.append(note_oct(5/6, 1))
# right.append(note_oct(3/2, 1))
# right.append(note_oct(4/3, 1))
# right.append(note_oct(5/4, 1))
# right.append(note_oct(1, 1))
# left.append(note(4/3 / 4, 1))
# left.append(note(1/2, 1))
# left.append(note(4/3 / 2, 1))
# left.append(note(3/2 / 2, 1))
# left.append(note(9/8 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(4/3 / 2, 1))
# left.append(note(5/4 / 2, 1))

# right.append(note_oct(5/4, 2))
# right.append(note_oct(5/6, 2))
# right.append(note_oct(1, 3))
# right.append(note_oct(1, 1/2))
# right.append(note_oct(5/6, 7/2))
# left.append(note(1 / 4, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(5/4 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(3/2 / 2, 1))

# right.append(note_oct(5/6, 1))
# right.append(note_oct(3/2, 1))
# right.append(note_oct(4/3, 1))
# right.append(note_oct(5/4, 1))
# right.append(note_oct(1, 1))
# left.append(note(4/3 / 4, 1))
# left.append(note(1/2, 1))
# left.append(note(4/3 / 2, 1))
# left.append(note(3/2 / 2, 1))
# left.append(note(9/8 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(4/3 / 2, 1))
# left.append(note(5/4 / 2, 1))

# right.append(note(5/4, 3.5))
# right.append(note(9/8*1, 0.5))
# right.append(note(5/4, 3.5))
# right.append(note(5/4, 0.5))
# left.append(note_chord([5/3 / 4, 4/3 / 4], 4))
# left.append(note_chord([5/3 / 4, 4/3 / 4, 9/8*1 / 4], 4))

# right.append(note(3/2, 0.5))
# right.append(note(5/3, 0.5))
# right.append(note(3/2, 1))
# right.append(note(5/4, 4))
# right.append(note(3/2, 2))
# left.append(note_chord([5/4 / 4, 1 / 2], 4))
# left.append(note_chord([1 / 4, 5/3 / 4], 4))

# right.append(note(5/4, 3.5))
# right.append(note(9/8*1, 0.5))
# right.append(note(1, 3.5))
# right.append(note(5/4, 0.5))
# left.append(note_chord([5/3 / 8, 1 / 4, 5/4 / 4, 1 / 2], 4))
# left.append(note_chord([3/2 / 8, 1 / 4, 5/4 / 4, 3/2 / 4], 4))

# right.append(note(3/2, 0.5))
# right.append(note(5/3, 0.5))
# right.append(note(5/3 / 2, 1))
# right.append(note(5/4, 4))
# right.append(note(1, 2))
# left.append(note_chord([1 / 4, 3/2 / 4, 1/2, 5/4 / 2], 4))
# left.append(note_chord([4/3 / 8, 1 / 4, 4/3 / 4, 5/3 / 4], 4))


# right.append(note(5/4, 0.5))
# right.append(note(5/4 * 2, 3))
# right.append(note(9/8*1, 0.5))
# right.append(note(5/4, 0.5))
# right.append(note(5/4 * 2, 3))
# right.append(note_oct(5/4, 0.5))
# left.append(note(5/3 / 8, 1))
# left.append(note(5/3 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(9/8*1 / 2, 1))
# left.append(note(1 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(9/8*1 / 2, 1))
# left.append(note(3/2 / 2, 1))

# right.append(note_oct(3/2, 0.5))
# right.append(note_oct(5/3, 0.5))
# right.append(note_oct(3/2, 0.5))
# right.append(note(3/2 * 4, 1.5))
# right.append(note(5/4 * 4, 3))
# right.append(note_oct(3/2, 2))
# left.append(note(4/3 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(5/3 / 2, 1))
# left.append(note(10/9 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(4/3 / 2, 1))
# left.append(note(10/9, 1))

# right.append(note_oct(5/4, 1/2))
# right.append(note(4, 1.5))
# right.append(note(5/6 * 4, 1.5))
# right.append(note_oct(9/8, 0.5))
# right.append(note_chord([1, 2, 9/8 * 2], 2.5))
# right.append(note(5/6 * 2, 1))
# right.append(note_oct(5/4, 1/2))
# left.append(note(5/4 / 2, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/6 / 2, 1))
# left.append(note(9/8 / 4, 1))
# left.append(note(5/4 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(3/2 / 2, 1))

# right.append(note(3/2, 0.5))
# right.append(note_oct(5/3, 0.5))
# right.append(note_oct(5/3 / 2, 2))
# right.append(note_oct(5/4 * 2, 2))
# right.append(note_oct(3/2, 0.5))
# right.append(note_oct(3/2, 0.5))
# right.append(note_oct(3/2, 9))
# left.append(note(4/3 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(5/4 / 2, 1))
# left.append(note(5/3 / 2, 1))
# left.append(note(1 / 4, 1))
# left.append(note(1 / 2, 1))
# left.append(note(1, 1))
# left.append(note(5/4 / 2, 9))

song = a.compose(*right) + a.compose(*left)

print("No reverb")
song.play()
print("'Jazz Hall' reverb") 
song.reverb(a.load(a.wave.open('Jazz Hall.wav', 'rb'))).play()
